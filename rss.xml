<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/">
    <channel>
        <title>fzdwx</title>
        <link>https://fzdwx.github.io</link>
        <description>What your say ?</description>
        <lastBuildDate>Sat, 22 Apr 2023 02:52:35 GMT</lastBuildDate>
        <docs>https://validator.w3.org/feed/docs/rss2.html</docs>
        <generator>https://github.com/jpmonette/feed</generator>
        <language>en-US</language>
        <image>
            <title>fzdwx</title>
            <url>https://fzdwx.github.io/favicon.ico</url>
            <link>https://fzdwx.github.io</link>
        </image>
        <copyright>© 2023-forever fzdwx</copyright>
        <item>
            <title><![CDATA[文章收藏]]></title>
            <link>https://fzdwx.github.io/content/issues/2.html</link>
            <guid>https://fzdwx.github.io/content/issues/2.html</guid>
            <pubDate>Sat, 22 Apr 2023 02:50:58 GMT</pubDate>
            <content:encoded><![CDATA[<ol>
<li><a href="https://arthurchiao.art/blog/how-nat-traversal-works-zh/" target="_blank" rel="noreferrer"> NAT 穿透是如何工作的：技术原理及企业级实践</a></li>
</ol>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[字体压缩]]></title>
            <link>https://fzdwx.github.io/content/posts/2023-04-20-compress-font.html</link>
            <guid>https://fzdwx.github.io/content/posts/2023-04-20-compress-font.html</guid>
            <pubDate>Thu, 20 Apr 2023 10:50:35 GMT</pubDate>
            <content:encoded><![CDATA[<p>先对比一下压缩前后的效果：</p>
<p><img src="/images/2023-04-20-18-53-12.png" alt="压缩前">
<img src="/images/2023-04-20-18-58-22.png" alt="压缩后"></p>
<p>主要是压缩了 f1 与 jinkai 这两个字体, f1 这个字体由于我之用到了几个字符所以很小, 大概思路:</p>
<ol>
<li>定义一个常用的字符集,里面包含你需要的字符</li>
<li>使用 pyftsubset 命令对字体进行压缩</li>
<li>使用 woff2 继续压缩为 woff2 格式</li>
</ol>
<div class="language-shell line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #FFCB6B">pyftsubset</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">input.ttf</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">--output-file=output.ttf</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">--text-file=subset.txt</span></span>
<span class="line"><span style="color: #FFCB6B">woff2_compress</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">output.ttf</span></span></code></pre>
<div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[go-zero 生成 curd 的逻辑]]></title>
            <link>https://fzdwx.github.io/content/posts/2023-04-18-go-zero-curd-logic.html</link>
            <guid>https://fzdwx.github.io/content/posts/2023-04-18-go-zero-curd-logic.html</guid>
            <pubDate>Tue, 18 Apr 2023 06:29:40 GMT</pubDate>
            <content:encoded><![CDATA[<p>go-zero 提供了一个很好用的工具 goctl, 可以用来生成一些模板代码, 比如根据 .api 文件生成 type, route, handle, logic 以及根据 table 生成 model 代码.</p>
<p>但却少了一个对我们这些 curd boy 更需要的功能, 就是根据 table dsl 生成 curd 的逻辑, 而这在 Java 生态中是一个很基础的功能(Mybatis).</p>
<p>个人猜测这可能跟 go 中各种 ORM 框架百花齐放的原因有关, 且 go-zero 也并没有强制使用某个 ORM 框架, 所以社区就没有实现这个功能.</p>
<p><strong>如何实现?</strong></p>
<p>其实很简单, goctl 已经提供了解析 .api 文件以及读取 table dsl 的功能, 我们只需要结合一下就可了.</p>
<ol>
<li>解析 .api 文件</li>
<li>读取 table 信息</li>
<li>通过 table 信息映射出 add, update, delete, page, get 等功能对应的 request 以及 response 的类型并放入 apiSpec 中</li>
<li>添加 route 到 apiSpec 中</li>
<li>定义 logic template, 这个是跟 ORM 强相关的, 需要根据情况来实现</li>
<li>生成 type, handle, logic 等代码</li>
<li>生成替换原有的 .api 文件, 我这里是将 curd 的 api 信息放在了单独的组中, 以便于区分, 在解析时可以通过自定义属性来设置</li>
<li>生成 route</li>
</ol>
<p>还可以加一些扩展功能, 比如根据 请求类型的 tag 来生成 where 条件, 目前我这边是默认为 eq, 但是可以根据 tag 来生成 like, gt, lt 等条件.</p>
<p>大概思路就是这样, 代码就不放出来丢人了...</p>
]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[并发控制-信号量]]></title>
            <link>https://fzdwx.github.io/content/docs/ostep/2023-04-15-ostep-sem.html</link>
            <guid>https://fzdwx.github.io/content/docs/ostep/2023-04-15-ostep-sem.html</guid>
            <pubDate>Sat, 15 Apr 2023 02:28:00 GMT</pubDate>
            <content:encoded><![CDATA[<p>信号量可以理解为一个装球的袋子(容器), 里面有一定数量的球(资源).</p>
<ul>
<li>每个人都可以从袋子里面取球, 取到球的人就可以使用这个球(资源)</li>
<li>如果袋子中没有球了,那就需要等待有人把球放回袋子里面</li>
</ul>
<div class="language-c line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">c</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #676E95; font-style: italic">// 尝试获取一个资源</span></span>
<span class="line"><span style="color: #676E95; font-style: italic">//  如果成功了, 离开</span></span>
<span class="line"><span style="color: #676E95; font-style: italic">//  如果失败了, 等待</span></span>
<span class="line"><span style="color: #C792EA">void</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">P</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">sem_t</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">*</span><span style="color: #A6ACCD; font-style: italic">sem</span><span style="color: #89DDFF">){</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #82AAFF">wait_until</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">sem</span><span style="color: #89DDFF">-&gt;</span><span style="color: #A6ACCD">value</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&gt;</span><span style="color: #F07178"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">){</span></span>
<span class="line"><span style="color: #F07178">    </span><span style="color: #A6ACCD">sem</span><span style="color: #89DDFF">-&gt;</span><span style="color: #A6ACCD">value</span><span style="color: #89DDFF">--;</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span>
<span class="line"></span>
<span class="line"><span style="color: #676E95; font-style: italic">// 释放一个资源</span></span>
<span class="line"><span style="color: #C792EA">void</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">V</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">sem_t</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">*</span><span style="color: #A6ACCD; font-style: italic">sem</span><span style="color: #89DDFF">){</span></span>
<span class="line"><span style="color: #F07178">  </span><span style="color: #A6ACCD">sem</span><span style="color: #89DDFF">-&gt;</span><span style="color: #A6ACCD">value</span><span style="color: #89DDFF">++;</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
<div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="信号量的应用" tabindex="-1">信号量的应用 <a class="header-anchor" href="#信号量的应用" aria-label="Permalink to &quot;信号量的应用&quot;">&ZeroWidthSpace;</a></h2>
<h3 id="实现生产者消费者模型" tabindex="-1">实现生产者消费者模型 <a class="header-anchor" href="#实现生产者消费者模型" aria-label="Permalink to &quot;实现生产者消费者模型&quot;">&ZeroWidthSpace;</a></h3>
<Gist user="fzdwx" id="444e7f36aa79d22519b42daff6221b00" height="h-[300px]" /><p>输出:</p>
<div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #FFCB6B">java</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">Main.java</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">1</span></span>
<span class="line"><span style="color: #FFCB6B">=&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">)()()</span><span style="color: #89DDFF">()</span></span>
<span class="line"></span>
<span class="line"><span style="color: #FFCB6B">java</span><span style="color: #A6ACCD"> </span><span style="color: #C3E88D">Main.java</span><span style="color: #A6ACCD"> </span><span style="color: #F78C6C">2</span></span>
<span class="line"><span style="color: #FFCB6B">=&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">))(())(())(())(())(</span><span style="color: #89DDFF">()</span><span style="color: #A6ACCD">)</span></span></code></pre>
<div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="实现-happens-before" tabindex="-1">实现 happens-before <a class="header-anchor" href="#实现-happens-before" aria-label="Permalink to &quot;实现 happens-before&quot;">&ZeroWidthSpace;</a></h3>
<p>下面的代码能保证 t1 先于 t2 打印</p>
<div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre v-pre class="shiki material-theme-palenight" ><code><span class="line"><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">class</span><span style="color: #A6ACCD"> </span><span style="color: #FFCB6B">Main</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">@</span><span style="color: #C792EA">SuppressWarnings</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">all</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">)</span></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #C792EA">public</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">static</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">void</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">main</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">String</span><span style="color: #89DDFF">[]</span><span style="color: #A6ACCD"> </span><span style="color: #A6ACCD; font-style: italic">args</span><span style="color: #89DDFF">)</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #C792EA">Semaphore</span><span style="color: #A6ACCD"> fill </span><span style="color: #89DDFF">=</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF; font-style: italic">new</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">Semaphore</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">new</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">Thread</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">Run</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">of</span><span style="color: #89DDFF">(()</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">-&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">            fill</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">acquire</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #A6ACCD">            System</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">out</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">println</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">t2</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">null;</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">})).</span><span style="color: #82AAFF">start</span><span style="color: #89DDFF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF; font-style: italic">new</span><span style="color: #A6ACCD"> </span><span style="color: #82AAFF">Thread</span><span style="color: #89DDFF">(</span><span style="color: #A6ACCD">Run</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">of</span><span style="color: #89DDFF">(()</span><span style="color: #A6ACCD"> </span><span style="color: #C792EA">-&gt;</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">{</span></span>
<span class="line"><span style="color: #A6ACCD">            System</span><span style="color: #89DDFF">.</span><span style="color: #A6ACCD">out</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">println</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">&quot;</span><span style="color: #C3E88D">t1</span><span style="color: #89DDFF">&quot;</span><span style="color: #89DDFF">);</span></span>
<span class="line"><span style="color: #A6ACCD">            fill</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">release</span><span style="color: #89DDFF">();</span></span>
<span class="line"><span style="color: #A6ACCD">            </span><span style="color: #89DDFF; font-style: italic">return</span><span style="color: #A6ACCD"> </span><span style="color: #89DDFF">null;</span></span>
<span class="line"><span style="color: #A6ACCD">        </span><span style="color: #89DDFF">})).</span><span style="color: #82AAFF">start</span><span style="color: #89DDFF">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: #A6ACCD">    </span><span style="color: #89DDFF">}</span></span>
<span class="line"><span style="color: #89DDFF">}</span></span></code></pre>
<div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div>]]></content:encoded>
        </item>
        <item>
            <title><![CDATA[在看的影视剧]]></title>
            <link>https://fzdwx.github.io/content/issues/1.html</link>
            <guid>https://fzdwx.github.io/content/issues/1.html</guid>
            <pubDate>Fri, 31 Mar 2023 11:07:07 GMT</pubDate>
            <content:encoded><![CDATA[<blockquote>
<p>记录一些影视作品的观看记录哈哈</p>
</blockquote>
<h2 id="最近在看" tabindex="-1">最近在看 <a class="header-anchor" href="#最近在看" aria-label="Permalink to &quot;最近在看&quot;">&ZeroWidthSpace;</a></h2>
<h3 id="动漫" tabindex="-1">动漫 <a class="header-anchor" href="#动漫" aria-label="Permalink to &quot;动漫&quot;">&ZeroWidthSpace;</a></h3>
<ClientOnly>
  <Douban code="35337634"/>
  <Douban code="36129263"/>
  <Douban code="35937645"/>
  <Douban code="35604677" to="https://ddys.art/the-witch-from-mercury/"/>
  <Douban code="35417872" to="https://ddys.art/isekaiojisan/"/>
  <Douban code="35853587"/>
</ClientOnly>
<h2 id="已看完" tabindex="-1">已看完 <a class="header-anchor" href="#已看完" aria-label="Permalink to &quot;已看完&quot;">&ZeroWidthSpace;</a></h2>
<h3 id="动漫-1" tabindex="-1">动漫 <a class="header-anchor" href="#动漫-1" aria-label="Permalink to &quot;动漫&quot;">&ZeroWidthSpace;</a></h3>
<ClientOnly>
  <Douban code="35351365"/>
  <Douban code="35256195" to="https://ddys.art/chainsaw-man" />
  <Douban code="35679830" to="https://www.bilibili.com/bangumi/play/ss39696" />
  <Douban code="35366293" to="https://ddys.art/bocchi-the-rock/"/>
  <Douban code="30238385" to="https://www.bilibili.com/bangumi/play/ss25742?spm_id_from=333.337.0.0"/>
</ClientOnly>
<h3 id="电影" tabindex="-1">电影 <a class="header-anchor" href="#电影" aria-label="Permalink to &quot;电影&quot;">&ZeroWidthSpace;</a></h3>
<ClientOnly>
  <Douban code="2124724" />
  <Douban code="1304624" to="https://www.bilibili.com/bangumi/play/ss32937" />
  <Douban code="1303173" />
  <Douban code="1291550" />
  <Douban code="27060077" />
  <Douban code="30270746" />
  <Douban code="30128916" />
  <Douban code="30323380" />
</ClientOnly>
<h3 id="电视剧" tabindex="-1">电视剧 <a class="header-anchor" href="#电视剧" aria-label="Permalink to &quot;电视剧&quot;">&ZeroWidthSpace;</a></h3>
<ClientOnly>
<Douban code="30198955" to="https://ddys.art/the-peripheral/" />
<Douban code="30291070" to="https://ddys.art/reborn-rich/" />
<Douban code="35314632" to="https://ddys.art/the-glory-2022" />
<Douban code="35465232" />
</ClientOnly>
]]></content:encoded>
        </item>
    </channel>
</rss>