import{_ as s,c as a,o as n,O as o}from"./chunks/framework.2b537b2f.js";const l="/images/8.png",b=JSON.parse('{"title":"写一个自己的github action","description":"","frontmatter":{"title":"写一个自己的github action","layout":"post","date":"2022-10-15T11:25:10.000Z","summary":"起因是因为想要有一种可以不用编辑文件而作用到网站上的方式,然后就了解到了 github action 的形式.","tags":["project"]},"headers":[],"relativePath":"content/posts/2022-10-15-about-github-action.md"}'),e={name:"content/posts/2022-10-15-about-github-action.md"},t=o(`<p>主要原理就是通过 github action 的来监听 issue 的相关事件,然后读取issue中的内容创建文件提交到 git 上,最后直接部署.这样就能随时编辑并展示了.</p><p>具体可以看 <a href="https://github.com/fzdwx/add-event-to-myblog" target="_blank" rel="noreferrer">add event to myb log</a>这个仓库, 以及<a href="https://github.com/fzdwx/fzdwx.github.io/blob/main/.github/workflows/add-event.yml" target="_blank" rel="noreferrer">使用方式</a>.</p><p>接下来介绍如何开发一个 github action:</p><h3 id="_1-克隆官方提供的template" tabindex="-1">1. 克隆官方提供的template <a class="header-anchor" href="#_1-克隆官方提供的template" aria-label="Permalink to &quot;1. 克隆官方提供的template&quot;">​</a></h3><p>官方主要对 typescript 的支持比较好,提供了一系列的<a href="https://github.com/actions/toolkit" target="_blank" rel="noreferrer">工具包</a>,没办法只能同ts来进行开发,</p><p><a href="https://github.com/actions/typescript-action" target="_blank" rel="noreferrer">https://github.com/actions/typescript-action</a></p><h3 id="_2-定义想要在运行时用户输入的参数" tabindex="-1">2. 定义想要在运行时用户输入的参数 <a class="header-anchor" href="#_2-定义想要在运行时用户输入的参数" aria-label="Permalink to &quot;2. 定义想要在运行时用户输入的参数&quot;">​</a></h3><p>通过编辑<code>action.yml</code>这个文件来定义想要在运行时定义的参数,比如说<code>GITHUB_TOKEN</code>:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">add event to my blog</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">description</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">add event to my blog</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">author</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">fzdwx</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">branding</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">icon</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">archive</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">white</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">inputs</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;"># 在这个key下面添加自定义参数</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">token</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">required</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FF9CAC;">true</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">description</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">the repo PAT or GITHUB_TOKEN</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F07178;">runs</span><span style="color:#89DDFF;">:</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">using</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">node16</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">main</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dist/index.js</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>参数有三个属性:</p><div class="language-yaml"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F07178;">required</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">是否必须</span></span>
<span class="line"><span style="color:#F07178;">description</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">描述</span></span>
<span class="line"><span style="color:#F07178;">default</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">默认值</span></span>
<span class="line"></span></code></pre></div><h3 id="_3-实现想要的功能" tabindex="-1">3. 实现想要的功能 <a class="header-anchor" href="#_3-实现想要的功能" aria-label="Permalink to &quot;3. 实现想要的功能&quot;">​</a></h3><p>详细可以查看我的<a href="https://github.com/fzdwx/add-event-to-myblog/blob/v2.1/src/main.ts" target="_blank" rel="noreferrer">主要代码</a>.我的里面主要做了:</p><ol><li>根据当前issue number<a href="https://github.com/fzdwx/add-event-to-myblog/blob/v2.1/src/main.ts#L16" target="_blank" rel="noreferrer">获取该issue的内容</a>.</li><li>根据预定义的模板,<a href="https://github.com/fzdwx/add-event-to-myblog/blob/v2.1/src/main.ts#L18-L33" target="_blank" rel="noreferrer">创建文件内容</a>.</li><li>提交到<a href="https://github.com/fzdwx/add-event-to-myblog/blob/v2.1/src/main.ts#L34-L38" target="_blank" rel="noreferrer">git</a>上.</li></ol><h3 id="_4-发布到marketplace" tabindex="-1">4. 发布到marketplace <a class="header-anchor" href="#_4-发布到marketplace" aria-label="Permalink to &quot;4. 发布到marketplace&quot;">​</a></h3><p>需要勾选 <strong>Publish this Action to the GitHub Marketplace</strong>,可能需要2fa认证,找一个 github 支持(我用的是 authy,防止后面忘记了)就ok了.</p><p><img src="`+l+'" alt="Figure 1"></p><p>成功 release 后就能在别的项目中使用了.</p>',18),p=[t];function r(c,i,y,D,F,h){return n(),a("div",null,p)}const u=s(e,[["render",r]]);export{b as __pageData,u as default};
